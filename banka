#include <stdio.h>
#include <stdlib.h>

/* ================== SYMBOLICKE KONSTANTY ================== */

/* rocni urokova mira (5.61 % podle tabulky) */
#define UROKOVA_MIRA 0.0561

/* dan z uroku 15 % */
#define DAN 0.15

/* minimalni a maximalni povoleny vklad */
#define MIN_VKLAD 0.0
#define MAX_VKLAD 10000000.0

/* rok vypisu - zmenou teto konstanty se program prizpusobi */
#define ROK 2023


/* ================== FUNKCE ================== */

/* Funkce nacte realne cislo v danem intervalu */
double nactiDoubleInterval(double min, double max) {
    double cislo;

    while (1) {
        if (scanf("%lf", &cislo) != 1) {
            printf("Neplatny vstup. Zadavej cisla.\n");

            /* vycisteni zbytku radku */
            int ch;
            while ((ch = getchar()) != '\n' && ch != EOF) { }

            continue;
        }

        if (cislo < min || cislo > max) {
            printf("Zadej cislo v intervalu %.2f az %.2f\n", min, max);
            continue;
        }

        return cislo;
    }
}

/* Funkce zjisti, jestli je rok prestupny */
int jePrestupny(int rok) {
    if ((rok % 4 == 0 && rok % 100 != 0) || (rok % 400 == 0))
        return 1;
    return 0;
}

/* Funkce vrati pocet dni v mesici */
int pocetDniVMesici(int mesic, int rok) {
    switch (mesic) {
        case 1: return 31;
        case 2:
            if (jePrestupny(rok))
                return 29;
            else
                return 28;
        case 3: return 31;
        case 4: return 30;
        case 5: return 31;
        case 6: return 30;
        case 7: return 31;
        case 8: return 31;
        case 9: return 30;
        case 10: return 31;
        case 11: return 30;
        case 12: return 31;
        default: return 30;
    }
}


/* ================== HLAVNI PROGRAM ================== */

int main() {

    double pocatecniStav;
    double mesicniVklad;
    double zustatek;

    double mesicniUrok;
    double danZUroku;

    double konecnyStav;
    double rozdil;

    printf("Simulace sporiciho uctu pro rok %d\n", ROK);
    printf("----------------------------------------\n");

    /* nacteni vstupu */
    printf("Zadej pocatecni stav uctu: ");
    pocatecniStav = nactiDoubleInterval(MIN_VKLAD, MAX_VKLAD);

    printf("Zadej pravidelny mesicni vklad: ");
    mesicniVklad = nactiDoubleInterval(MIN_VKLAD, MAX_VKLAD);

    printf("\nSporici ucet, rocni urokova mira %.2f %%\n", UROKOVA_MIRA * 100.0);
    printf("Stav uctu na pocatku roku %d je %.2f Kc.\n\n", ROK, pocatecniStav);

    printf("--------------------------------------------------------------------------\n");
    printf("datum       na pocatku mesice   vklad     urok     dan z uroku(15%%)   na konci mesice\n");
    printf("--------------------------------------------------------------------------\n");

    /* na zacatku roku */
    zustatek = pocatecniStav;

    /* cyklus pres vsechny mesice */
    for (int mesic = 1; mesic <= 12; mesic++) {

        /* stav na zacatku mesice (pred vkladem) */
        double stavNaZacatku = zustatek;

        /* po pripocitani mesicniho vkladu */
        double poVkladu = stavNaZacatku + mesicniVklad;

        /* vypocet mesicniho uroku (rocni mira / 12) */
        mesicniUrok = poVkladu * (UROKOVA_MIRA / 12.0);

        /* vypocet dane */
        danZUroku = mesicniUrok * DAN;

        /* konecny stav mesice */
        zustatek = poVkladu + mesicniUrok - danZUroku;

        int den = pocetDniVMesici(mesic, ROK);

        /* Formatovani podobne tabulce: dd.mm.yyyy  zacatek  vklad  urok  dan  konec */
        printf("%02d.%02d.%d   %12.2f Kc   %8.2f Kc   %8.2f Kc   %12.2f Kc   %12.2f Kc\n",
               den, mesic, ROK,
               stavNaZacatku,
               mesicniVklad,
               mesicniUrok,
               danZUroku,
               zustatek);
    }

    /* bod 7 */
    konecnyStav = zustatek;
    rozdil = konecnyStav - pocatecniStav;

    printf("--------------------------------------------------------------------------\n");
    printf("Stav na konci roku %d je %.2f Kc. Usetril jsi %.2f Kc.\n", ROK, konecnyStav, rozdil);

    return 0;
}
